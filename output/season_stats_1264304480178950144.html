<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IBAC Dynasty - Season Stats</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f5f5f5;
        }
        .nav-bar {
            background-color: rgba(255, 255, 255, 0.95);
            padding: 15px 30px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 15px;
        }
        .nav-bar .nav-title {
            font-size: 24px;
            font-weight: bold;
            color: #667eea;
            margin: 0;
        }
        .nav-links {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }
        .nav-links a {
            text-decoration: none;
            color: #667eea;
            padding: 8px 16px;
            border-radius: 5px;
            transition: all 0.3s;
            font-weight: 500;
        }
        .nav-links a:hover {
            background-color: #667eea;
            color: white;
        }
        .nav-links a.active {
            background-color: #667eea;
            color: white;
        }
        .content-wrapper {
            padding: 20px;
        }
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            border-radius: 10px;
            margin-bottom: 30px;
        }
        h1 {
            margin: 0;
            font-size: 2.5em;
        }
        .subtitle {
            margin-top: 10px;
            opacity: 0.9;
        }
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        .stat-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .stat-title {
            font-size: 0.9em;
            color: #666;
            text-transform: uppercase;
            margin-bottom: 10px;
        }
        .stat-value {
            font-size: 2em;
            font-weight: bold;
            color: #333;
        }
        .chart-container {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        .chart-title {
            font-size: 1.3em;
            font-weight: bold;
            margin-bottom: 15px;
            color: #333;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        th {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 15px;
            text-align: left;
            cursor: pointer;
            user-select: none;
            position: relative;
        }
        th[title] {
            cursor: help;
        }
        th:hover {
            opacity: 0.9;
        }
        th::after {
            content: ' ‚áÖ';
            opacity: 0.5;
            font-size: 0.9em;
        }
        th.sort-asc::after {
            content: ' ‚ñ≤';
            opacity: 1;
        }
        th.sort-desc::after {
            content: ' ‚ñº';
            opacity: 1;
        }
        td {
            padding: 12px 15px;
            border-bottom: 1px solid #eee;
        }
        tr:hover {
            background-color: #f8f9fa;
        }
        .trend-up {
            color: #28a745;
            font-weight: bold;
        }
        .trend-down {
            color: #dc3545;
            font-weight: bold;
        }
        .trend-stable {
            color: #ffc107;
        }
        .eliminated {
            color: #6c757d;
            font-style: italic;
        }
        .team-selector {
            margin-bottom: 15px;
            padding: 10px;
            background: #f8f9fa;
            border-radius: 5px;
        }
        .team-checkbox {
            margin-right: 20px;
            margin-bottom: 8px;
            display: inline-block;
        }
        .team-checkbox input {
            margin-right: 5px;
        }
        .team-checkbox label {
            cursor: pointer;
            user-select: none;
        }
        .awards-section {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            margin-bottom: 30px;
        }
        .awards-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        .award-card {
            background: linear-gradient(135deg, #ffeaa7 0%, #fdcb6e 100%);
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            border: 3px solid #f39c12;
        }
        .award-icon {
            font-size: 2.5em;
            text-align: center;
            margin-bottom: 10px;
        }
        .award-title {
            font-size: 1.1em;
            font-weight: bold;
            color: #2c3e50;
            text-align: center;
            margin-bottom: 10px;
        }
        .award-winner {
            font-size: 1.3em;
            font-weight: bold;
            color: #8e44ad;
            text-align: center;
            margin-bottom: 5px;
        }
        .award-value {
            font-size: 0.9em;
            color: #555;
            text-align: center;
        }
    </style>
</head>
<body>
    <nav class="nav-bar">
        <div class="nav-title">üèà Fantasy Tool</div>
        <div class="nav-links">
            <a href="../index.html">Home</a>
            <a href="player_stats.html">Player Stats</a>
            <a href="defense_stats.html">Defense Stats</a>
            <a href="season_stats.html" class="active">Season Stats</a>
        </div>
    </nav>
    <div class="content-wrapper">
    <div class="header">
        <h1>IBAC Dynasty</h1>
        <div class="subtitle">Season Statistics Report - Week 15 | 2025</div>
    </div>
   
    <div class="stats-grid">
        <div class="stat-card">
            <div class="stat-title">League Average PPG</div>
            <div class="stat-value">128.5</div>
        </div>
        <div class="stat-card">
            <div class="stat-title">Highest Efficiency</div>
            <div class="stat-value">85.7%</div>
        </div>
        <div class="stat-card">
            <div class="stat-title">Total Points Left on Bench</div>
            <div class="stat-value">3979</div>
        </div>
        <div class="stat-card">
            <div class="stat-title">Most FAAB Remaining</div>
            <div class="stat-value">$89</div>
        </div>
    </div>
   
    <div class="chart-container">
        <div class="chart-title">Detailed Team Statistics</div>
        <table id="statsTable">
            <thead>
                <tr>
                    <th onclick="sortTable(0)" title="Team ranking in the table">Rank</th>
                    <th onclick="sortTable(1)" title="Team owner name">Team</th>
                    <th onclick="sortTable(2)" title="Win-Loss record">W-L</th>
                    <th onclick="sortTable(3)" title="Average points scored per game">Avg PPG</th>
                    <th onclick="sortTable(4)" title="Lineup efficiency: (Actual Points / Optimal Points) √ó 100. Measures how well you set your lineup.">Efficiency</th>
                    <th onclick="sortTable(5)" title="Total points left on bench across all weeks. Lower is better.">Bench Pts</th>
                    <th onclick="sortTable(6)" title="Expected wins-losses based on Pythagorean formula (PF^2.54 / (PF^2.54 + PA^2.54)). Shows what your record 'should be' based on scoring.">Pythag W-L</th>
                    <th onclick="sortTable(7)" title="Luck factor: Actual wins minus expected wins. Positive (green) = lucky, Negative (red) = unlucky.">Luck</th>
                    <th onclick="sortTable(8)" title="Hypothetical record if you played every team each week. Better indicator of true team strength than head-to-head record.">All-Play</th>
                    <th onclick="sortTable(9)" title="Scoring consistency: Mean/StdDev. Higher = more consistent week-to-week. >5 is very consistent, <3 is boom-or-bust.">Consistency</th>
                    <th onclick="sortTable(10)" title="Total FAAB (waiver budget) spent on acquisitions">FAAB Used</th>
                    <th onclick="sortTable(11)" title="Points per dollar: Points scored by waiver-acquired players / FAAB spent. Higher is better waiver efficiency.">Pt/$</th>
                    <th onclick="sortTable(12)" title="Recent trend: Last 4 weeks vs early season average. ‚ñ≤ = heating up, ‚ñº = cooling down">Trend</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>1</td>
                    <td><strong>emiliosolay</strong></td>
                    <td>12-2</td>
                    <td>155.6</td>
                    <td>85.7%</td>
                    <td>364.7</td>
                    <td>9.3-4.7</td>
                    <td><span class="trend-up">+2.7</span></td>
                    <td>95-31 (0.754)</td>
                    <td>5.18</td>
                    <td>$44</td>
                    <td>2.39</td>
                    <td><span class="trend-down">‚ñº 28.5%</span></td>
                </tr>
                <tr>
                    <td>2</td>
                    <td><strong>dbyrd55</strong></td>
                    <td>8-6</td>
                    <td>119.3</td>
                    <td>85.2%</td>
                    <td>289.5</td>
                    <td>6.9-7.1</td>
                    <td><span class="trend-up">+1.1</span></td>
                    <td>48-78 (0.381)</td>
                    <td>6.36</td>
                    <td>$22</td>
                    <td>4.62</td>
                    <td><span class="trend-down">‚ñº 6.7%</span></td>
                </tr>
                <tr>
                    <td>3</td>
                    <td><strong>SeanRabenaldt</strong></td>
                    <td>8-6</td>
                    <td>137.7</td>
                    <td>85.0%</td>
                    <td>341.0</td>
                    <td>7.2-6.8</td>
                    <td><span class="trend-up">+0.8</span></td>
                    <td>72-54 (0.571)</td>
                    <td>6.51</td>
                    <td>$95</td>
                    <td>0.29</td>
                    <td><span class="trend-stable">‚Äî</span></td>
                </tr>
                <tr>
                    <td>4</td>
                    <td><strong>Taubitz</strong></td>
                    <td>6-8</td>
                    <td>124.4</td>
                    <td>84.8%</td>
                    <td>313.1</td>
                    <td>6.3-7.7</td>
                    <td>-0.3</td>
                    <td>66-60 (0.524)</td>
                    <td>4.77</td>
                    <td>$40</td>
                    <td>2.36</td>
                    <td><span class="trend-down">‚ñº 16.7%</span></td>
                </tr>
                <tr>
                    <td>5</td>
                    <td><strong>Sangha</strong></td>
                    <td>7-7</td>
                    <td>125.9</td>
                    <td>83.3%</td>
                    <td>353.6</td>
                    <td>6.8-7.2</td>
                    <td>0.2</td>
                    <td>60-66 (0.476)</td>
                    <td>5.17</td>
                    <td>$22</td>
                    <td>2.39</td>
                    <td><span class="trend-stable">‚Äî</span></td>
                </tr>
                <tr>
                    <td>6</td>
                    <td><strong>agrusa17</strong></td>
                    <td>4-10</td>
                    <td>120.7</td>
                    <td>79.7%</td>
                    <td>431.1</td>
                    <td>6.1-7.9</td>
                    <td><span class="trend-down">-2.1</span></td>
                    <td>58-68 (0.460)</td>
                    <td>5.32</td>
                    <td>$97</td>
                    <td>1.71</td>
                    <td><span class="trend-down">‚ñº 5.9%</span></td>
                </tr>
                <tr>
                    <td>7</td>
                    <td><strong>NLadocsi</strong></td>
                    <td>9-5</td>
                    <td>124.4</td>
                    <td>79.5%</td>
                    <td>448.5</td>
                    <td>7.2-6.8</td>
                    <td><span class="trend-up">+1.8</span></td>
                    <td>63-63 (0.500)</td>
                    <td>7.39</td>
                    <td>$57</td>
                    <td>0.54</td>
                    <td><span class="trend-stable">‚Äî</span></td>
                </tr>
                <tr>
                    <td>8</td>
                    <td><strong>B-Ray</strong></td>
                    <td>6-8</td>
                    <td>120.7</td>
                    <td>79.1%</td>
                    <td>447.5</td>
                    <td>6.6-7.4</td>
                    <td><span class="trend-down">-0.6</span></td>
                    <td>44-82 (0.349)</td>
                    <td>9.15</td>
                    <td>$20</td>
                    <td>4.36</td>
                    <td><span class="trend-stable">‚Äî</span></td>
                </tr>
                <tr>
                    <td>9</td>
                    <td><strong>BTThomp</strong></td>
                    <td>6-8</td>
                    <td>138.5</td>
                    <td>78.4%</td>
                    <td>533.5</td>
                    <td>7.2-6.8</td>
                    <td><span class="trend-down">-1.2</span></td>
                    <td>82-44 (0.651)</td>
                    <td>6.40</td>
                    <td>$11</td>
                    <td>2.79</td>
                    <td><span class="trend-down">‚ñº 12.9%</span></td>
                </tr>
                <tr>
                    <td>10</td>
                    <td><strong>McInally</strong></td>
                    <td>4-10</td>
                    <td>117.7</td>
                    <td>78.3%</td>
                    <td>456.1</td>
                    <td>6.2-7.8</td>
                    <td><span class="trend-down">-2.2</span></td>
                    <td>42-84 (0.333)</td>
                    <td>5.04</td>
                    <td>$63</td>
                    <td>3.48</td>
                    <td><span class="trend-down">‚ñº 8.0%</span></td>
                </tr>
            </tbody>
        </table>
    </div>
   
    <div class="awards-section">
        <div class="chart-title">üèÜ Season Awards üèÜ</div>
        <div class="awards-grid">
            <div class="award-card">
                <div class="award-icon">üèÜ</div>
                <div class="award-title">Highest Scorer</div>
                <div class="award-winner">emiliosolay</div>
                <div class="award-value">2178.0 points</div>
            </div>
            <div class="award-card">
                <div class="award-icon">üéØ</div>
                <div class="award-title">Best Manager</div>
                <div class="award-winner">emiliosolay</div>
                <div class="award-value">85.7% efficiency</div>
            </div>
            <div class="award-card">
                <div class="award-icon">üìä</div>
                <div class="award-title">Most Consistent</div>
                <div class="award-winner">B-Ray</div>
                <div class="award-value">9.15 consistency</div>
            </div>
            <div class="award-card">
                <div class="award-icon">üîÆ</div>
                <div class="award-title">Waiver Wire Wizard</div>
                <div class="award-winner">dbyrd55</div>
                <div class="award-value">4.62 Pt/$</div>
            </div>
            <div class="award-card">
                <div class="award-icon">ü™ë</div>
                <div class="award-title">Bench Warmer Award</div>
                <div class="award-winner">BTThomp</div>
                <div class="award-value">533.5 pts on bench</div>
            </div>
            <div class="award-card">
                <div class="award-icon">üî•</div>
                <div class="award-title">Highest Weekly Score</div>
                <div class="award-winner">emiliosolay</div>
                <div class="award-value">200.8 pts (Week 7)</div>
            </div>
            <div class="award-card">
                <div class="award-icon">üí©</div>
                <div class="award-title">Lowest Weekly Score</div>
                <div class="award-winner">Taubitz</div>
                <div class="award-value">55.8 pts (Week 14)</div>
            </div>
            <div class="award-card">
                <div class="award-icon">üçÄ</div>
                <div class="award-title">Luckiest Team</div>
                <div class="award-winner">emiliosolay</div>
                <div class="award-value">+2.7 wins above expected</div>
            </div>
            <div class="award-card">
                <div class="award-icon">üò¢</div>
                <div class="award-title">Unluckiest Team</div>
                <div class="award-winner">McInally</div>
                <div class="award-value">-2.2 wins below expected</div>
            </div>
            <div class="award-card">
                <div class="award-icon">üí•</div>
                <div class="award-title">Boom or Bust</div>
                <div class="award-winner">Taubitz</div>
                <div class="award-value">4.77 consistency</div>
            </div>
            <div class="award-card">
                <div class="award-icon">üòê</div>
                <div class="award-title">Most Average Team</div>
                <div class="award-winner">Sangha</div>
                <div class="award-value">125.9 PPG (league avg: 128.5)</div>
            </div>
        </div>
    </div>

    <div class="chart-container">
        <div class="chart-title">Weekly Scoring Trends (All Teams)</div>
        <div class="team-selector" id="teamSelector">
            <strong>Select teams to display:</strong><br>
        </div>
        <canvas id="weeklyTrendsChart"></canvas>
    </div>
   
    <div class="chart-container">
        <div class="chart-title">Sit/Start Efficiency by Team</div>
        <canvas id="efficiencyChart"></canvas>
    </div>
   
    <div class="chart-container">
        <div class="chart-title">Average Points Per Game</div>
        <canvas id="avgPointsChart"></canvas>
    </div>
   
    <div class="chart-container">
        <div class="chart-title">FAAB Efficiency (Points per $ Spent)</div>
        <canvas id="faabEfficiencyChart"></canvas>
    </div>

    <div class="chart-container">
        <div class="chart-title">Pythagorean Expectation (Actual vs Expected Wins)</div>
        <canvas id="pythagChart"></canvas>
    </div>

    <div class="chart-container">
        <div class="chart-title">League Average Points Per Week</div>
        <canvas id="leagueAvgChart"></canvas>
    </div>
   
    <script>
        // Efficiency Chart
        new Chart(document.getElementById('efficiencyChart'), {
            type: 'bar',
            data: {
                labels: ['emiliosolay', 'dbyrd55', 'SeanRabenaldt', 'Taubitz', 'Sangha', 'agrusa17', 'NLadocsi', 'B-Ray', 'BTThomp', 'McInally'],
                datasets: [{
                    label: 'Efficiency Rate (%)',
                    data: [85.7, 85.2, 85.0, 84.8, 83.3, 79.7, 79.5, 79.1, 78.4, 78.3],
                    backgroundColor: 'rgba(102, 126, 234, 0.7)',
                    borderColor: 'rgba(102, 126, 234, 1)',
                    borderWidth: 2
                }]
            },
            options: {
                indexAxis: 'y',
                responsive: true,
                plugins: {
                    legend: { display: false }
                },
                scales: {
                    x: {
                        beginAtZero: true,
                        max: 100,
                        title: { display: true, text: 'Efficiency %' }
                    }
                }
            }
        });
       
        // Average Points Chart
        new Chart(document.getElementById('avgPointsChart'), {
            type: 'bar',
            data: {
                labels: ['emiliosolay', 'dbyrd55', 'SeanRabenaldt', 'Taubitz', 'Sangha', 'agrusa17', 'NLadocsi', 'B-Ray', 'BTThomp', 'McInally'],
                datasets: [{
                    label: 'Avg Points Per Game',
                    data: [155.6, 119.3, 137.7, 124.4, 125.9, 120.7, 124.4, 120.7, 138.5, 117.7],
                    backgroundColor: 'rgba(118, 75, 162, 0.7)',
                    borderColor: 'rgba(118, 75, 162, 1)',
                    borderWidth: 2
                }]
            },
            options: {
                indexAxis: 'y',
                responsive: true,
                plugins: {
                    legend: { display: false }
                },
                scales: {
                    x: {
                        beginAtZero: true,
                        title: { display: true, text: 'Points' }
                    }
                }
            }
        });
       
        // FAAB Efficiency Chart
        new Chart(document.getElementById('faabEfficiencyChart'), {
            type: 'bar',
            data: {
                labels: ['emiliosolay', 'dbyrd55', 'SeanRabenaldt', 'Taubitz', 'Sangha', 'agrusa17', 'NLadocsi', 'B-Ray', 'BTThomp', 'McInally'],
                datasets: [{
                    label: 'Points per Dollar Spent',
                    data: [2.39, 4.62, 0.29, 2.36, 2.39, 1.71, 0.54, 4.36, 2.79, 3.48],
                    backgroundColor: 'rgba(40, 167, 69, 0.7)',
                    borderColor: 'rgba(40, 167, 69, 1)',
                    borderWidth: 2
                }]
            },
            options: {
                indexAxis: 'y',
                responsive: true,
                plugins: {
                    legend: { display: false }
                },
                scales: {
                    x: {
                        beginAtZero: true,
                        title: { display: true, text: 'Points/$' }
                    }
                }
            }
        });

        // Pythagorean Expectation Chart
        new Chart(document.getElementById('pythagChart'), {
            type: 'bar',
            data: {
                labels: ['emiliosolay', 'dbyrd55', 'SeanRabenaldt', 'Taubitz', 'Sangha', 'agrusa17', 'NLadocsi', 'B-Ray', 'BTThomp', 'McInally'],
                datasets: [
                    {
                        label: 'Actual Wins',
                        data: [12, 8, 8, 6, 7, 4, 9, 6, 6, 4],
                        backgroundColor: 'rgba(102, 126, 234, 0.7)',
                        borderColor: 'rgba(102, 126, 234, 1)',
                        borderWidth: 2
                    },
                    {
                        label: 'Expected Wins (Pythag)',
                        data: [9.3, 6.9, 7.2, 6.3, 6.8, 6.1, 7.2, 6.6, 7.2, 6.2],
                        backgroundColor: 'rgba(255, 159, 64, 0.7)',
                        borderColor: 'rgba(255, 159, 64, 1)',
                        borderWidth: 2
                    }
                ]
            },
            options: {
                indexAxis: 'y',
                responsive: true,
                plugins: {
                    legend: { display: true, position: 'top' },
                    tooltip: {
                        callbacks: {
                            label: function(context) {
                                return context.dataset.label + ': ' + context.parsed.x.toFixed(1);
                            }
                        }
                    }
                },
                scales: {
                    x: {
                        beginAtZero: true,
                        title: { display: true, text: 'Wins' }
                    }
                }
            }
        });

        // Weekly Trends Chart with team selection
        const allColors = [
            'rgba(255, 99, 132, 1)', 'rgba(54, 162, 235, 1)', 'rgba(255, 206, 86, 1)',
            'rgba(75, 192, 192, 1)', 'rgba(153, 102, 255, 1)', 'rgba(255, 159, 64, 1)',
            'rgba(255, 159, 132, 1)', 'rgba(99, 255, 132, 1)', 'rgba(132, 99, 255, 1)',
            'rgba(255, 206, 132, 1)', 'rgba(132, 206, 255, 1)', 'rgba(206, 132, 255, 1)'
        ];
       
        const weeklyTeamData = {
            'emiliosolay': [153.78, 174.4, 163.38, 186.58, 153.6, 145.9, 200.76, 133.82, 197.96, 186.54, 108.72, 145.44, 109.54, 117.56],
            'dbyrd55': [94.14, 103.88, 91.44, 121.16, 130.38, 148.02, 154.9, 132.36, 118.22, 126.66, 103.06, 96.74, 125.7, 124.22],
            'SeanRabenaldt': [128.28, 135.1, 131.48, 133.98, 187.58, 118.9, 129.06, 108.64, 124.38, 155.34, 157.92, 130.3, 117.66, 169.26],
            'Taubitz': [135.9, 116.08, 103.34, 148.42, 158.52, 148.78, 131.48, 140.42, 112.72, 97.58, 123.84, 119.1, 149.86, 55.78],
            'Sangha': [94.84, 125.32, 79.46, 173.04, 148.38, 122.1, 149.52, 136.12, 109.02, 97.12, 138.88, 118.72, 146.96, 123.0],
            'agrusa17': [119.56, 84.62, 132.82, 141.28, 166.4, 78.96, 131.6, 115.34, 126.62, 132.36, 124.02, 129.88, 118.48, 87.72],
            'NLadocsi': [110.2, 145.48, 113.92, 129.74, 93.66, 146.3, 134.08, 112.56, 132.76, 102.6, 117.58, 150.4, 115.12, 137.5],
            'B-Ray': [131.68, 131.66, 110.94, 119.94, 137.38, 107.64, 106.56, 98.72, 126.56, 145.72, 122.92, 118.1, 104.88, 127.74],
            'BTThomp': [131.3, 176.8, 152.34, 143.36, 123.12, 128.82, 140.46, 169.6, 115.42, 162.08, 132.44, 147.2, 123.1, 92.84],
            'McInally': [141.0, 76.36, 127.68, 141.98, 147.28, 91.56, 131.02, 129.56, 121.68, 89.42, 85.6, 144.88, 102.42, 117.44],
        };
       
        // Create team selector checkboxes
        const teamSelector = document.getElementById('teamSelector');
        const teamNames = Object.keys(weeklyTeamData);
       
        teamNames.forEach((team, idx) => {
            const checkbox = document.createElement('div');
            checkbox.className = 'team-checkbox';
            checkbox.innerHTML = `
                <input type="checkbox" id="team_${idx}" value="${team}"
                    ${idx < 6 ? 'checked' : ''} onchange="updateWeeklyChart()">
                <label for="team_${idx}">${team}</label>
            `;
            teamSelector.appendChild(checkbox);
        });
       
        // Initialize weekly trends chart
        let weeklyChart = null;
       
        function updateWeeklyChart() {
            const selectedTeams = [];
            teamNames.forEach((team, idx) => {
                const checkbox = document.getElementById(`team_${idx}`);
                if (checkbox && checkbox.checked) {
                    selectedTeams.push(team);
                }
            });
           
            const datasets = selectedTeams.map((team, idx) => {
                const color = allColors[teamNames.indexOf(team) % allColors.length];
                return {
                    label: team,
                    data: weeklyTeamData[team],
                    borderColor: color,
                    backgroundColor: color.replace('1)', '0.1)'),
                    tension: 0,
                    borderWidth: 2
                };
            });
           
            // Add league average as a dashed line
            datasets.push({
                label: 'League Average',
                data: [124.1, 127.0, 120.7, 143.9, 144.6, 123.7, 140.9, 127.7, 128.5, 129.5, 121.5, 130.1, 121.4, 115.3],
                borderColor: 'rgba(128, 128, 128, 0.8)',
                backgroundColor: 'rgba(128, 128, 128, 0)',
                borderDash: [10, 5],
                tension: 0,
                borderWidth: 3,
                pointRadius: 0
            });
           
            if (weeklyChart) {
                weeklyChart.destroy();
            }
           
            weeklyChart = new Chart(document.getElementById('weeklyTrendsChart'), {
                type: 'line',
                data: {
                    labels: Array.from({length: 15}, (_, i) => 'Week ' + (i + 1)),
                    datasets: datasets
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: { display: true, position: 'top' }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: { display: true, text: 'Points Scored' }
                        }
                    }
                }
            });
        }
       
        // Initialize chart with first 6 teams selected
        updateWeeklyChart();
       
        // League Average Points Per Week Chart
        const weekLabels = Array.from({length: 14}, (_, i) => `Week ${i + 1}`);
        new Chart(document.getElementById('leagueAvgChart'), {
            type: 'line',
            data: {
                labels: weekLabels,
                datasets: [{
                    label: 'League Average Points',
                    data: [124.1, 127.0, 120.7, 143.9, 144.6, 123.7, 140.9, 127.7, 128.5, 129.5, 121.5, 130.1, 121.4, 115.3],
                    backgroundColor: 'rgba(118, 75, 162, 0.2)',
                    borderColor: 'rgba(118, 75, 162, 1)',
                    borderWidth: 3,
                    fill: true,
                    tension: 0.3,
                    pointRadius: 4,
                    pointBackgroundColor: 'rgba(118, 75, 162, 1)'
                }]
            },
            options: {
                responsive: true,
                plugins: {
                    legend: { display: true },
                    tooltip: {
                        callbacks: {
                            label: function(context) {
                                return context.dataset.label + ': ' + context.parsed.y.toFixed(1) + ' pts';
                            }
                        }
                    }
                },
                scales: {
                    y: {
                        beginAtZero: true,
                        title: { display: true, text: 'Average Points' }
                    },
                    x: {
                        title: { display: true, text: 'Week' }
                    }
                }
            }
        });
    </script>
   
    <script>
        // Table sorting functionality
        let sortDirection = {};
       
        function sortTable(columnIndex) {
            const table = document.getElementById('statsTable');
            const tbody = table.querySelector('tbody');
            const rows = Array.from(tbody.querySelectorAll('tr'));
            const headers = table.querySelectorAll('th');
           
            // Toggle sort direction
            if (sortDirection[columnIndex] === 'asc') {
                sortDirection[columnIndex] = 'desc';
            } else {
                sortDirection[columnIndex] = 'asc';
            }
           
            // Remove sort indicators from all headers
            headers.forEach(h => {
                h.classList.remove('sort-asc', 'sort-desc');
            });
           
            // Add sort indicator to current header
            headers[columnIndex].classList.add(sortDirection[columnIndex] === 'asc' ? 'sort-asc' : 'sort-desc');
           
            // Sort rows
            rows.sort((a, b) => {
                let aVal = a.cells[columnIndex].textContent.trim();
                let bVal = b.cells[columnIndex].textContent.trim();
               
                // Extract numeric values from cells
                let aNum = parseFloat(aVal.replace(/[^0-9.-]/g, ''));
                let bNum = parseFloat(bVal.replace(/[^0-9.-]/g, ''));
               
                // Compare
                let comparison = 0;
                if (!isNaN(aNum) && !isNaN(bNum)) {
                    comparison = aNum - bNum;
                } else {
                    comparison = aVal.localeCompare(bVal);
                }
               
                return sortDirection[columnIndex] === 'asc' ? comparison : -comparison;
            });
           
            // Reattach sorted rows and update rank column (only for non-Chopped leagues)
            rows.forEach((row, index) => {
                tbody.appendChild(row);
                // Update rank column only if it exists (Dynasty leagues have rank in first column)
                if (row.cells[0].textContent.match(/^\d+$/)) {
                    row.cells[0].textContent = index + 1; // Update rank
                }
            });
        }
    </script>
    </div>
</body>
</html>
